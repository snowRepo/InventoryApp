<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:InventoryApp.ViewModels"
             xmlns:conv="using:InventoryApp.Converters"
             x:Class="InventoryApp.Views.DashboardView"
             x:DataType="vm:DashboardViewModel">
    
    <UserControl.Resources>
        <conv:BoolToBrushConverter x:Key="BoolToBrush"/>
    </UserControl.Resources>
    
    <Grid RowDefinitions="Auto,Auto,*" ColumnDefinitions="*">
        <!-- Header -->
        <StackPanel Grid.Row="0" Spacing="8">
            <TextBlock Text="Dashboard" FontSize="24" FontWeight="Bold"/>
            <Border Height="1" Background="#E0E0E0" Margin="0,0,0,8"/>
        </StackPanel>

    <Grid Grid.Row="1" ColumnDefinitions="*,*,*,*" ColumnSpacing="12">
      <Border Background="#FFFFFF" CornerRadius="6" Padding="12" BorderBrush="#E1E6EF" BorderThickness="1" >
        <StackPanel>
          <TextBlock Text="Total products" Opacity="0.7"/>
          <TextBlock Text="{Binding TotalProducts}" FontSize="24" FontWeight="Bold"/>
        </StackPanel>
      </Border>
      <Border Grid.Column="1" Background="#FFFFFF" CornerRadius="6" Padding="12" BorderBrush="#E1E6EF" BorderThickness="1" >
        <StackPanel>
          <TextBlock Text="Sales today" Opacity="0.7"/>
          <TextBlock Text="{Binding FormattedSalesToday}" FontSize="24" FontWeight="Bold"/>
        </StackPanel>
      </Border>
      <Border Grid.Column="2" Background="#FFFFFF" CornerRadius="6" Padding="12" BorderBrush="#E1E6EF" BorderThickness="1" >
        <StackPanel>
          <TextBlock Text="All-time sales" Opacity="0.7"/>
          <TextBlock Text="{Binding FormattedSalesAllTime}" FontSize="24" FontWeight="Bold"/>
        </StackPanel>
      </Border>
      <Border Grid.Column="3" Background="#FFFFFF" CornerRadius="6" Padding="12" BorderBrush="#E1E6EF" BorderThickness="1" >
        <StackPanel>
          <TextBlock Text="Inventory value" Opacity="0.7"/>
          <TextBlock Text="{Binding FormattedInventoryValue}" FontSize="24" FontWeight="Bold"/>
        </StackPanel>
      </Border>
    </Grid>

    <StackPanel Grid.Row="2" Margin="0,16,0,0" Spacing="16">
      <!-- Low stock section -->
      <StackPanel Spacing="8">
        <TextBlock Text="Low stock" FontSize="16" FontWeight="Bold"/>

        <TextBlock Text="No low stock items. Low stock items will appear here."
                   Opacity="0.7"
                   IsVisible="{Binding NoLowStock}"/>

        <ItemsControl ItemsSource="{Binding LowStock}" IsVisible="{Binding HasLowStock}">
          <ItemsControl.ItemTemplate>
            <DataTemplate x:DataType="vm:LowStockItem">
              <Border Background="#FFFFFF" CornerRadius="6" Padding="10" BorderBrush="#E1E6EF" BorderThickness="1" Margin="0,4,0,0">
                <Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="12">
                  <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                  <TextBlock Grid.Column="1" Text="{Binding FormattedUnitPrice}" VerticalAlignment="Center"/>
                  <TextBlock Grid.Column="2" Text="{Binding Quantity, StringFormat='{}{0} left'}" VerticalAlignment="Center"/>
                </Grid>
              </Border>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </StackPanel>

      <!-- Near expiry section -->
      <StackPanel Spacing="8">
        <TextBlock Text="Nearing expiry (next 30 days)" FontSize="16" FontWeight="Bold"/>

        <TextBlock Text="No products nearing expiry. Products with expiry dates close to today will appear here."
                   Opacity="0.7"
                   IsVisible="{Binding NoNearExpiry}"/>

        <ItemsControl ItemsSource="{Binding NearExpiry}" IsVisible="{Binding HasNearExpiry}">
          <ItemsControl.ItemTemplate>
            <DataTemplate x:DataType="vm:NearExpiryItem">
              <Border Background="#FFFFFF" CornerRadius="6" Padding="10" BorderBrush="#E1E6EF" BorderThickness="1" Margin="0,4,0,0">
                <Grid ColumnDefinitions="*,Auto,Auto" ColumnSpacing="12">
                  <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                  <TextBlock Grid.Column="1" Text="{Binding FormattedExpiryDate}" VerticalAlignment="Center"/>
                  <TextBlock Grid.Column="2" Text="{Binding DaysRemaining, StringFormat='{}{0} days left'}" VerticalAlignment="Center"/>
                </Grid>
              </Border>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </StackPanel>
    </StackPanel>
  </Grid>
</UserControl>
